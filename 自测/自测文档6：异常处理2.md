# 自测文档6：异常处理2

## 一、选择题（共20题，每题2分）

1. 以下关于Python异常处理的描述，错误的是（ ）
A. 异常是程序运行过程中发生的错误
B. 可以使用try-except语句捕获异常
C. 异常处理可以提高程序的健壮性
D. 所有异常都必须被捕获

2. 以下哪个语句用于捕获异常？（ ）
A. try
B. except
C. else
D. finally

3. 以下哪个语句用于在发生异常时执行清理操作？（ ）
A. try
B. except
C. else
D. finally

4. 关于try-except-else结构，以下描述正确的是（ ）
A. else块在没有发生异常时执行
B. else块在发生异常时执行
C. else块必须跟在finally块之后
D. else块不能单独使用

5. 以下哪个语句用于手动抛出异常？（ ）
A. try
B. except
C. raise
D. assert

6. 以下哪个语句用于断言？（ ）
A. try
B. except
C. raise
D. assert

7. 关于自定义异常，以下描述正确的是（ ）
A. 自定义异常必须继承自Exception类
B. 自定义异常可以使用raise语句抛出
C. 自定义异常可以添加自定义属性和方法
D. 以上都正确

8. 以下哪个异常是Python的内置异常？（ ）
A. ValueError
B. TypeError
C. ZeroDivisionError
D. 以上都正确

9. 以下关于异常处理的最佳实践，错误的是（ ）
A. 应该捕获具体的异常，而不是所有异常
B. 应该在except块中记录异常信息
C. 应该在finally块中释放资源
D. 可以使用裸露的except语句捕获所有异常

10. 以下哪个异常是用于表示索引超出范围？（ ）
A. IndexError
B. KeyError
C. NameError
D. AttributeError

11. 以下哪个异常是用于表示字典键不存在？（ ）
A. IndexError
B. KeyError
C. NameError
D. AttributeError

12. 以下哪个异常是用于表示变量未定义？（ ）
A. IndexError
B. KeyError
C. NameError
D. AttributeError

13. 以下哪个异常是用于表示对象没有该属性？（ ）
A. IndexError
B. KeyError
C. NameError
D. AttributeError

14. 以下关于try-finally结构，以下描述正确的是（ ）
A. finally块无论是否发生异常都会执行
B. finally块只在发生异常时执行
C. finally块只在没有发生异常时执行
D. finally块可以省略

15. 以下哪个语句用于捕获多个异常？（ ）
A. except (Exception1, Exception2):
B. except Exception1, Exception2:
C. except Exception1 and Exception2:
D. except Exception1 or Exception2:

16. 以下关于异常链，以下描述正确的是（ ）
A. 异常链用于保留原始异常的信息
B. 可以使用from关键字创建异常链
C. 可以使用raise...from...语句创建异常链
D. 以上都正确

17. 以下哪个函数用于获取异常的详细信息？（ ）
A. str()
B. repr()
C. traceback.format_exc()
D. print()

18. 以下关于断言的描述，错误的是（ ）
A. 断言用于检查程序的逻辑错误
B. 断言可以使用assert语句
C. 断言在生产环境中默认开启
D. 断言失败会抛出AssertionError异常

19. 以下哪个模块用于获取异常的堆栈信息？（ ）
A. traceback
B. logging
C. os
D. sys

20. 以下关于异常处理的描述，正确的是（ ）
A. 异常处理可以替代正常的错误检查
B. 异常处理应该用于处理预期的错误
C. 异常处理应该用于处理意外的错误
D. 异常处理会降低程序的执行效率

## 二、填空题（共20题，每题2分）

1. 异常是程序运行过程中发生的______。

2. 捕获异常使用______语句。

3. 手动抛出异常使用______语句。

4. 断言使用______语句。

5. finally块无论是否发生异常都会______。

6. else块在______时执行。

7. 自定义异常必须继承自______类或其子类。

8. 除以零会抛出______异常。

9. 索引超出范围会抛出______异常。

10. 字典键不存在会抛出______异常。

11. 变量未定义会抛出______异常。

12. 对象没有该属性会抛出______异常。

13. 类型错误会抛出______异常。

14. 值错误会抛出______异常。

15. 用于获取异常堆栈信息的模块是______。

16. 异常链使用______关键字创建。

17. 在except块中，可以使用______变量获取异常对象。

18. 捕获所有异常使用______语句。

19. 关闭文件等资源应该放在______块中。

20. 断言失败会抛出______异常。

## 三、简答题（共4题，每题5分）

1. 简述try-except-else-finally结构的执行流程。

2. 简述异常处理的优点。

3. 简述自定义异常的使用场景。

4. 简述异常处理的最佳实践。

## 四、实践操作题（共2题，每题10分）

1. 编写程序，实现一个除法函数，处理除数为零的情况，并返回友好的错误信息。

2. 编写程序，自定义一个异常类，用于处理年龄输入不合法的情况。

# 参考答案

## 一、选择题

1. D 2. B 3. D 4. A 5. C 6. D 7. D 8. D 9. D 10. A
11. B 12. C 13. D 14. A 15. A 16. D 17. C 18. C 19. A 20. C

## 二、填空题

1. 错误 2. try-except 3. raise 4. assert 5. 执行 6. 没有发生异常 7. Exception 8. ZeroDivisionError 9. IndexError 10. KeyError 11. NameError 12. AttributeError 13. TypeError 14. ValueError 15. traceback 16. from 17. as 18. except Exception: 19. finally 20. AssertionError

## 三、简答题

1. try-except-else-finally结构的执行流程：
   - 执行try块中的代码
   - 如果发生异常，执行对应的except块中的代码
   - 如果没有发生异常，执行else块中的代码
   - 无论是否发生异常，最后执行finally块中的代码

2. 异常处理的优点：
   - 提高程序的健壮性，使程序在遇到错误时不会崩溃
   - 提供友好的错误信息，便于调试和用户理解
   - 可以集中处理错误，代码更简洁
   - 可以在发生异常时执行清理操作

3. 自定义异常的使用场景：
   - 当内置异常不能满足需求时
   - 用于表示特定业务逻辑的错误
   - 便于区分不同类型的错误
   - 可以添加自定义属性和方法，提供更丰富的错误信息

4. 异常处理的最佳实践：
   - 捕获具体的异常，而不是所有异常
   - 不要使用裸露的except语句
   - 在except块中记录异常信息
   - 在finally块中释放资源
   - 不要使用异常处理替代正常的错误检查
   - 保持异常处理代码简洁
   - 使用自定义异常表示特定业务逻辑的错误

## 四、实践操作题

1. 除法函数，处理除数为零：
```python
def safe_divide(a, b):
    try:
        result = a / b
        return f"除法结果：{result}"
    except ZeroDivisionError:
        return "错误：除数不能为零！"
    except TypeError:
        return "错误：请输入数字类型！"

# 测试
print(safe_divide(10, 2))    # 输出：除法结果：5.0
print(safe_divide(10, 0))    # 输出：错误：除数不能为零！
print(safe_divide(10, "a"))  # 输出：错误：请输入数字类型！
```

2. 自定义异常处理年龄输入：
```python
# 自定义异常类
class InvalidAgeError(Exception):
    def __init__(self, age, message="年龄输入不合法"):
        self.age = age
        self.message = message
        super().__init__(self.message)
    
    def __str__(self):
        return f"{self.message}：{self.age}。年龄必须在0-120之间。"

def check_age(age):
    try:
        age = int(age)
        if age < 0 or age > 120:
            raise InvalidAgeError(age)
        return f"您的年龄是：{age}岁"
    except ValueError:
        return "错误：请输入有效的数字！"
    except InvalidAgeError as e:
        return str(e)

# 测试
print(check_age(25))    # 输出：您的年龄是：25岁
print(check_age(-5))    # 输出：年龄输入不合法：-5。年龄必须在0-120之间。
print(check_age(150))   # 输出：年龄输入不合法：150。年龄必须在0-120之间。
print(check_age("abc")) # 输出：错误：请输入有效的数字！
```